# ğŸ¯ ETA Auto-Reset & Arrival Time - Visual Guide

## Feature Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FEATURE 1: Auto-Reset ETA to 0 when Gate Opens       â”‚
â”‚  FEATURE 2: Show Exact Arrival Time (HH:MM:SS AM/PM)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Scenario 1: Normal Train Approach

```
Time: 2:43:00 PM
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Train Status: Train Approaching          â”‚
â”‚ Gate Status: Closing                     â”‚
â”‚                                          â”‚
â”‚ ETA (s) / Arrives at 02:45:30 PM        â”‚
â”‚              135.5                       â”‚
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 60%               â”‚
â”‚                                          â”‚
â”‚ Last updated: 02:43:00 PM                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Firebase Data:
{
  "event": "train_detected",
  "gate_status": "closing",
  "eta_sec": 135.5,
  "speed_kmh": 45.2
}

Calculation:
Current: 2:43:00 PM (14:43:00)
+ ETA: 135.5 seconds
= Arrival: 2:45:15 PM (14:45:15)
Display: "Arrives at 02:45:15 PM"
```

---

## Scenario 2: Gate Opens (â­ AUTO-RESET)

```
Time: 2:44:30 PM
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Train Status: Train Approaching          â”‚
â”‚ Gate Status: Opening  â­ TRIGGER!        â”‚
â”‚                                          â”‚
â”‚ ETA to Gate (s)                          â”‚
â”‚              0.00      â­ RESET!          â”‚
â”‚ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%                â”‚
â”‚                                          â”‚
â”‚ Last updated: 02:44:30 PM                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Firebase Data:
{
  "event": "gate_opened",  â­ TRIGGER
  "gate_status": "opening", â­ TRIGGER
  "eta_sec": 60.5,  â† Ignored
  "speed_kmh": 45.2
}

Auto-Reset Logic Activated:
âœ… if (event == "gate_opened") â†’ ETA = 0
âœ… if (gateStatus == "opening") â†’ ETA = 0
âœ… Stop countdown timer
âœ… Reset progress bar
âœ… Clear arrival time display
```

---

## Scenario 3: Train Crossed

```
Time: 2:45:00 PM
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Train Status: Train Crossed              â”‚
â”‚ Gate Status: Opening                     â”‚
â”‚                                          â”‚
â”‚ ETA to Gate (s)                          â”‚
â”‚              0.00                        â”‚
â”‚ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0%                â”‚
â”‚                                          â”‚
â”‚ Speed: 0.00 km/h                         â”‚
â”‚ Last updated: 02:45:00 PM                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Firebase Data:
{
  "event": "train_crossed",  â­ TRIGGER
  "gate_status": "opening",
  "eta_sec": 0.0,
  "speed_kmh": 0.0
}

Auto-Reset Logic:
âœ… if (event == "train_crossed") â†’ ETA = 0
âœ… if (event == "train_crossed") â†’ Speed = 0
```

---

## Code Flow Diagram

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘               ESP32 Railway Crossing System              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                         â†“
                   Sends Event
                         â†“
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                   Firebase Database                      â•‘
â•‘              RailwayGate/current/                        â•‘
â•‘  {                                                       â•‘
â•‘    event: "train_detected"                               â•‘
â•‘    gate_status: "closing"                                â•‘
â•‘    eta_sec: 135.5                                        â•‘
â•‘    speed_kmh: 45.2                                       â•‘
â•‘  }                                                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                         â†“
                 Firebase Listener
                         â†“
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          RailwayCrossingRepository.kt                    â•‘
â•‘                                                          â•‘
â•‘  processLatestLog(snapshot) {                            â•‘
â•‘    val event = snapshot.child("event").value             â•‘
â•‘    val gateStatus = snapshot.child("gate_status").value  â•‘
â•‘    val eta = snapshot.child("eta_sec").value             â•‘
â•‘                                                          â•‘
â•‘    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â•‘
â•‘    â”‚ â­ AUTO-RESET LOGIC                    â”‚           â•‘
â•‘    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â•‘
â•‘    â”‚ if (event == "gate_opened" ||          â”‚           â•‘
â•‘    â”‚     event == "train_crossed" ||        â”‚           â•‘
â•‘    â”‚     event == "system_reset" ||         â”‚           â•‘
â•‘    â”‚     gateStatus == "opening") {         â”‚           â•‘
â•‘    â”‚   etaValue = "0.00"  â† FORCE RESET!    â”‚           â•‘
â•‘    â”‚ } else {                               â”‚           â•‘
â•‘    â”‚   etaValue = eta                       â”‚           â•‘
â•‘    â”‚ }                                      â”‚           â•‘
â•‘    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â•‘
â•‘                                                          â•‘
â•‘    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â•‘
â•‘    â”‚ â­ CALCULATE ARRIVAL TIME              â”‚           â•‘
â•‘    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â•‘
â•‘    â”‚ if (etaSeconds > 0) {                  â”‚           â•‘
â•‘    â”‚   currentTime = System.currentTime()   â”‚           â•‘
â•‘    â”‚   arrivalTime = currentTime + eta      â”‚           â•‘
â•‘    â”‚   format = "Arrives at HH:MM:SS AM/PM" â”‚           â•‘
â•‘    â”‚ } else {                               â”‚           â•‘
â•‘    â”‚   format = "--"                        â”‚           â•‘
â•‘    â”‚ }                                      â”‚           â•‘
â•‘    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â•‘
â•‘                                                          â•‘
â•‘    _etaToGate.postValue(etaValue)                       â•‘
â•‘    _arrivalTime.postValue(arrivalTimeText)              â•‘
â•‘  }                                                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                         â†“
                 LiveData Updates
                         â†“
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  HomeViewModel.kt                        â•‘
â•‘                                                          â•‘
â•‘  val etaToGate: LiveData<String> = repository.etaToGate â•‘
â•‘  val arrivalTime: LiveData<String> = ...                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                         â†“
                   Observes Data
                         â†“
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  HomeFragment.kt                         â•‘
â•‘                                                          â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â•‘
â•‘  â”‚ Gate Status Observer                     â”‚           â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â•‘
â•‘  â”‚ if (status == "Opening" || "Open") {     â”‚           â•‘
â•‘  â”‚   â­ FORCE UI RESET                      â”‚           â•‘
â•‘  â”‚   - Stop countdown timer                 â”‚           â•‘
â•‘  â”‚   - Set ETA to 0.00                      â”‚           â•‘
â•‘  â”‚   - Reset progress bar                   â”‚           â•‘
â•‘  â”‚   - Stop train approaching flag          â”‚           â•‘
â•‘  â”‚ }                                        â”‚           â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â•‘
â•‘                                                          â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â•‘
â•‘  â”‚ Arrival Time Observer                    â”‚           â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â•‘
â•‘  â”‚ if (arrivalTime != "--") {               â”‚           â•‘
â•‘  â”‚   label = "ETA (s) / " + arrivalTime     â”‚           â•‘
â•‘  â”‚ } else {                                 â”‚           â•‘
â•‘  â”‚   label = "ETA to Gate (s)"              â”‚           â•‘
â•‘  â”‚ }                                        â”‚           â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                         â†“
                   Updates UI
                         â†“
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  User Interface                          â•‘
â•‘                                                          â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â•‘
â•‘  â”‚ ETA (s) / Arrives at 02:45:30 PM       â”‚ â† Dynamic   â•‘
â•‘  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤             â•‘
â•‘  â”‚          135.5 seconds                 â”‚ â† Updates   â•‘
â•‘  â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 60%              â”‚ â† Progress  â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## Auto-Reset Trigger Points

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           4 Ways ETA Auto-Resets to 0                    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                          â•‘
â•‘  1ï¸âƒ£  event == "gate_opened"                             â•‘
â•‘      â””â”€â†’ When ESP32 sends gate open command             â•‘
â•‘                                                          â•‘
â•‘  2ï¸âƒ£  gateStatus == "opening"                            â•‘
â•‘      â””â”€â†’ When gate is in opening state                  â•‘
â•‘                                                          â•‘
â•‘  3ï¸âƒ£  event == "train_crossed"                           â•‘
â•‘      â””â”€â†’ When train passes sensor 3                     â•‘
â•‘                                                          â•‘
â•‘  4ï¸âƒ£  event == "system_reset"                            â•‘
â•‘      â””â”€â†’ When no train detected for timeout period      â•‘
â•‘                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## Time Calculation Example

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘            Arrival Time Calculation                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                          â•‘
â•‘  Input:                                                  â•‘
â•‘  â”œâ”€ Current Time: 2025-10-29 14:43:15                   â•‘
â•‘  â”œâ”€ ETA Seconds: 135.5                                  â•‘
â•‘  â””â”€ Timezone: Local                                     â•‘
â•‘                                                          â•‘
â•‘  Calculation:                                            â•‘
â•‘  â”œâ”€ Current Millis: 1730208195000                       â•‘
â•‘  â”œâ”€ Add Seconds: +135500 ms                             â•‘
â•‘  â””â”€ Arrival Millis: 1730208330500                       â•‘
â•‘                                                          â•‘
â•‘  Formatting:                                             â•‘
â•‘  â”œâ”€ Pattern: "hh:mm:ss a"                               â•‘
â•‘  â”œâ”€ Result: "02:45:30 PM"                               â•‘
â•‘  â””â”€ Display: "Arrives at 02:45:30 PM"                   â•‘
â•‘                                                          â•‘
â•‘  Final Output:                                           â•‘
â•‘  "ETA (s) / Arrives at 02:45:30 PM"                     â•‘
â•‘                                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## State Transitions

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   IDLE STATE                            â”‚
â”‚  ETA: 0.00 | Arrival: "--" | Gate: Open                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
              Train Detected (Sensor 1)
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                APPROACHING STATE                        â”‚
â”‚  ETA: 135.5 | Arrival: "02:45:30 PM" | Gate: Closing   â”‚
â”‚  Progress: Counting Down â–¼                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
          Gate Opens â­ OR Train Crosses â­
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               AUTO-RESET STATE                          â”‚
â”‚  ETA: 0.00 â­ | Arrival: "--" | Gate: Opening/Open     â”‚
â”‚  Progress: Stopped                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
                System Resets
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   IDLE STATE                            â”‚
â”‚  ETA: 0.00 | Arrival: "--" | Gate: Open                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Testing Scenarios

### âœ… Test 1: Normal Approach
```
1. Train detected â†’ ETA shows 135.5s
2. Check display â†’ "Arrives at 02:45:30 PM"
3. Wait 10 seconds â†’ ETA becomes 125.5s
4. Check display â†’ "Arrives at 02:45:20 PM"
âœ… Pass if arrival time updates correctly
```

### âœ… Test 2: Gate Opens (Auto-Reset)
```
1. Train approaching â†’ ETA shows 90.0s
2. Gate starts opening â†’ Gate Status = "Opening"
3. Check ETA â†’ Should be 0.00 â­
4. Check label â†’ "ETA to Gate (s)" (no arrival time)
5. Check progress â†’ 0%
âœ… Pass if ETA immediately resets to 0
```

### âœ… Test 3: Train Crosses
```
1. Train approaching â†’ ETA shows 45.0s
2. Train crosses sensor 3 â†’ event = "train_crossed"
3. Check ETA â†’ Should be 0.00 â­
4. Check Speed â†’ Should be 0.00 â­
5. Check status â†’ "Train Crossed"
âœ… Pass if both ETA and Speed reset
```

### âœ… Test 4: System Reset
```
1. No train for 30+ seconds â†’ event = "system_reset"
2. Check ETA â†’ Should be 0.00
3. Check display â†’ "ETA to Gate (s)"
4. Check gate â†’ "Open"
âœ… Pass if system returns to idle state
```

---

## Quick Reference

| State | ETA | Arrival Time | Label |
|-------|-----|--------------|-------|
| **Idle** | 0.00 | -- | "ETA to Gate (s)" |
| **Approaching** | 135.5 | 02:45:30 PM | "ETA (s) / Arrives at..." |
| **Gate Opening** | 0.00 â­ | -- | "ETA to Gate (s)" |
| **Train Crossed** | 0.00 â­ | -- | "ETA to Gate (s)" |

---

**Status:** âœ… Ready for Testing  
**Documentation:** Complete  
**Next Step:** Build â†’ Run â†’ Test
